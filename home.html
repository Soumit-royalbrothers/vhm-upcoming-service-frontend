<html>
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
      crossorigin="anonymous"
    ></script>

    <script>
      window.onload = function getData() {
        fetch('https://fetch-gsheet-data.herokuapp.com/get-data')
          .then((response) => {
            return response.json();
          })
          .then((data) => {
            // Work with JSON data here
            for (i = 0; i <= data.length; i++) {
              if (data[i]['Vehicle No'] != '') {
                var table = document.getElementById('bikes-table');
                var row = table.insertRow(i + 1);
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var cell3 = row.insertCell(2);
                var cell4 = row.insertCell(3);
                var cell5 = row.insertCell(4);
                cell1.innerHTML = i + 1;
                cell2.innerHTML = data[i]['Vehicle No'];
                cell3.innerHTML = data[i]['Model'];
                cell4.innerHTML = data[i]['Odo'];
                cell5.innerHTML = data[i]['Service Type'];
              }
            }
          })
          .catch((err) => {
            // Do something for an error here
            console.log(err);
          });
      };
    </script>
  </head>
  <body>
    <center>
      <div class="container">
      <h1>Upcoming Service</h1>
      <table class="table table-striped" id="bikes-table">
        <thead>
          <tr>
            <th scope="col">Sl No.</th>
            <th scope="col">Vehicle No.</th>
            <th scope="col">Model</th>
            <th scope="col">Odo</th>
            <th scope="col">Service Type</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </center>
  </div>
  </body>
</html>
